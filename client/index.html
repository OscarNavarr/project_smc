<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Weather Stations's Data">
    <meta name="keywords" content="Weather, Data, Weather Data">
    <meta name="author" content="Oscar Navarro">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    
    <title>Weather Stations</title>

    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="/static/css/styles.css">

    <!-- Google Charts CDN -->
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

</head>
<body>
    
   <div class="bg_images_special h-[100vh] relative">
        <!-- Modal component-->
        <div id="matplotlib_modal_component" class="hidden fixed z-10 inset-0 h-[100vh] w-[100vw] bg-modal-container">
            <div class="w-full h-full flex justify-center items-center">
                <img id="img_matplotlib_chart" src="" class="w-[70%] h-[30rem]" alt="chart">
            </div>
        </div>
        <!-- Fin modal component-->

        <div class="flex h-[100vh] bg_degred">
            <div class="w-[calc(100vw-50rem)] h-[100vh]  flex justify-center items-center">
                <div class="">
                    <div class="flex justify-center">
                        <h1 id="h1_temp" class="text-white text-[10rem]">0</h1>
                        <p class="text-white text-[7rem]">°C</p>
                    </div>
                    <div class="w-full">
                        <h2 class="text-white text-[3.5rem] text-center">Dernière Mesure</h2>
                        <div class="w-full flex justify-center mt-[2rem]">
                            <button type="button" id="show_matplotlib_chart" class="text-white text-[1.4rem] rounded-[2rem] glassmorphism_bg p-[1.5rem] up-and-down-animation">Montrer le graphique fait avec matplotlib</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="w-[100%] glassmorphism_bg rounded-l-[3rem] p-[3rem]">
                <div class="flex flex-col">
                    <div class="overflow-x-auto sm:-mx-6 lg:-mx-8">
                        <div class="inline-block min-w-full py-2 sm:px-6 lg:px-8 ">
                            <div class="overflow-y-scroll max-h-[20rem] flex justify-center rounded-[1rem]">
                                <table class="w-full text-left text-sm font-light text-surface dark:text-white rounded-t-xl ">
                                    <thead class="border-b border-neutral-200 font-medium dark:border-white/10 thead-glass-bg text-white rounded-t-xl">
                                        <tr>
                                            <th scope="col" class="px-6 py-4">#</th>
                                            <th scope="col" class="px-6 py-4">Récolte</th>
                                            <th scope="col" class="px-6 py-4">Nom Station</th>
                                            <th scope="col" class="px-6 py-4">Ville</th>
                                            <th scope="col" class="px-6 py-4">Température</th>
                                            <th scope="col" class="px-6 py-4">Humidité du Sol</th>
                                            <th scope="col" class="px-6 py-4">Humidité de l'air</th>
                                            <th scope="col" class="px-6 py-4">Pluviosité</th>
                                        </tr>
                                    </thead>
                                    <tbody></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div> 
                
                <div id="container_google_chart" class="w-full flex justify-center ">
                    <div id="curve_chart" style="width: 100%; height: 500px" ></div>
                </div>
                
            </div>
        </div>
   </div>
    
    <script src="/static/js/js_code.js"></script>
    <script src="/static/js/handle_btn_show_chart.js"></script>
    <script type="text/javascript" async>
        google.charts.load('current');
        function drawVisualization(data) {
            var options = {
                title: 'Évolution de la Température',
                curveType: 'function',
                legend: { position: 'bottom'},
                pointSize: 10,
                vAxis: {
                    title: 'Température',
                    textStyle: { color: '#fff' },
                    titleTextStyle: { color: '#fff' },
                    areaOpacity: 0.2,
                    viewWindow: {
                        min: 0,
                    },
                    gridlines: {
                        color: '#fff',
                    },
                },
                hAxis: {
                    title: 'Jours',
                    textStyle: { color: '#fff' },
                    titleTextStyle: { color: '#fff' },
                    viewWindow: {
                        min: 0,
                    },
                },
                backgroundColor: 'transparent',
                colors: ['#fff'],
                titleTextStyle: {
                    color: '#fff',
                    fontSize: 20,
                },
                legendTextStyle: {
                    color: '#fff',
                    fontSize: 14,
                },
                /*
                animation: {
                    duration: 1000, 
                    easing: 'out',
                    startup: true, 
                    refreshInterval: 1000 
                }
                */
            };
                
            google.visualization.drawChart({
                "containerId": "curve_chart",
                "dataTable": [['Mois', 'Température'], ...data ],
                "refreshInterval": 5,
                "chartType": "AreaChart",
                "options": options
            });
        }
        google.charts.setOnLoadCallback(() => drawVisualization(all_data)); 
        
    
        
    
        /*
            setInterval(() => {
                // Delete the div with the id curve_chart
                document.getElementById('curve_chart').remove();  
                
                // Create a new div with the id curve_chart
                let new_div = document.createElement('div');
                new_div.id = 'curve_chart';   
                new_div.classList.add('w-full', 'h-[500px]');
                document.getElementById('container_google_chart').appendChild(new_div); 
                
                
                console.log('Chart updated')         
            }, 1000);
        */
    </script>

    
    
</body>
</html>